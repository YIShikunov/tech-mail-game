define([
    'backbone',
    'tmpl/game'
], function(
    Backbone,
    tmpl
){

    var GameView = Backbone.View.extend({
        template: tmpl,

        initialize: function () {
            this.$el.addClass("gameView__playView");
            this.$el.appendTo('.gameView');
            this.render();
        },

        render: function () {
            this.$el.html(this.template());
            this.draw();
        },

        show: function () {
            this.$el.show();
            this.trigger('show',this);
        },

        hide: function () {
            this.$el.hide();
        },
        
        draw: function() {
            var canvas = document.getElementsByClassName("game__field");
            var ctx = canvas[0].getContext('2d');

            ctx.fillStyle = "green";
            ctx.strokeStyle = "white";

            field = [[[0.0, 2.0], [0.95, 2.69], [0.59, 3.81], [-0.59, 3.81], [-0.95, 2.69]],
                    [[0.0, -2.0], [0.95, -2.69], [0.59, -3.81], [-0.59, -3.81], [-0.95, -2.69]],
                    [[0.0, 4.83], [-0.59, 3.81], [0.59, 3.81]],
                    [[-1.74, 3.56], [-0.95, 2.69], [-0.59, 3.81]],
                    [[-1.07, 1.52], [-0.0, 2.0], [-0.95, 2.69]],
                    [[1.07, 1.52], [0.95, 2.69], [0.0, 2.0]],
                    [[1.74, 3.56], [0.59, 3.81], [0.95, 2.69]],
                    [[-1.25, 4.78], [-0.59, 3.81], [-0.07, 4.87]],
                    [[-1.75, 3.65], [-0.59, 3.81], [-1.31, 4.74]],
                    [[-2.08, 2.37], [-0.95, 2.69], [-1.8, 3.51]],
                    [[-1.16, 1.53], [-0.95, 2.69], [-2.06, 2.29]],
                    [[-0.04, 0.83], [-0.0, 2.0], [-1.04, 1.45]],
                    [[1.04, 1.45], [-0.0, 2.0], [0.04, 0.83]],
                    [[2.06, 2.29], [0.95, 2.69], [1.16, 1.53]],
                    [[1.8, 3.51], [0.95, 2.69], [2.08, 2.37]],
                    [[1.31, 4.74], [0.59, 3.81], [1.75, 3.65]],
                    [[0.07, 4.87], [0.59, 3.81], [1.25, 4.78]],
                    [[0.0, -4.83], [-0.59, -3.81], [0.59, -3.81]],
                    [[1.74, -3.56], [0.59, -3.81], [0.95, -2.69]],
                    [[1.07, -1.52], [0.95, -2.69], [0.0, -2.0]],
                    [[-1.07, -1.52], [-0.0, -2.0], [-0.95, -2.69]],
                    [[-1.74, -3.56], [-0.95, -2.69], [-0.59, -3.81]],
                    [[1.25, -4.78], [0.07, -4.87], [0.59, -3.81]],
                    [[1.75, -3.65], [1.31, -4.74], [0.59, -3.81]],
                    [[2.08, -2.37], [1.8, -3.51], [0.95, -2.69]],
                    [[1.16, -1.53], [2.06, -2.29], [0.95, -2.69]],
                    [[0.04, -0.83], [1.04, -1.45], [0.0, -2.0]],
                    [[-1.04, -1.45], [-0.04, -0.83], [0.0, -2.0]],
                    [[-2.06, -2.29], [-1.16, -1.53], [-0.95, -2.69]],
                    [[-1.8, -3.51], [-2.08, -2.37], [-0.95, -2.69]],
                    [[-1.31, -4.74], [-1.75, -3.65], [-0.59, -3.81]],
                    [[-0.07, -4.87], [-1.25, -4.78], [-0.59, -3.81]],
                    [[2.6, 0.0], [5.2, 1.5], [5.2, -1.5]],
                    [[-2.6, 0.0], [-5.2, 1.5], [-5.2, -1.5]],
                    [[2.6, 0.0], [2.6, 3.0], [5.2, 1.5]],
                    [[-2.6, 0.0], [-5.2, -1.5], [-2.6, -3.0]],
                    [[2.6, 0.0], [-0.0, 1.5], [2.6, 3.0]],
                    [[-2.6, 0.0], [-2.6, -3.0], [0.0, -1.5]],
                    [[2.6, 0.0], [-0.0, -1.5], [0.0, 1.5]],
                    [[-2.6, 0.0], [-0.0, -1.5], [0.0, 1.5]],
                    [[2.6, 0.0], [2.6, -3.0], [-0.0, -1.5]],
                    [[-2.6, 0.0], [0.0, 1.5], [-2.6, 3.0]],
                    [[2.6, 0.0], [5.2, -1.5], [2.6, -3.0]],
                    [[-2.6, 0.0], [-2.6, 3.0], [-5.2, 1.5]]]

            for (i=0; i<field.length; i++) {
                console.info(field[i]);
                this.draw_base(ctx,field[i]);
            }

        },  
        draw_base: function(context,point) {
            x = 390;
            y = 300
            zoom = 50;
            context.beginPath();
            context.moveTo( x+point[0][0]*zoom, y+point[0][1]*zoom);
            for (k=1; k<point.length; k++) {
                 context.lineTo( x+point[k][0]*zoom, y+point[k][1]*zoom);
            }
            context.fill();
            context.stroke();
            context.closePath();
        }

    });

    return new GameView();
});